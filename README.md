# Malware-Dismantle-Official
### Summary:
Used to practice basic malware analysis, and to assist the SOC in analyzing email attachments. I programmed this to practice my malware analysis process. The script only does static analysis (dismantle) and will not execute any malicious code. The script will report on information that may be useful in SOC/IR work where there is no time to delve-deep into how the malware works. It is useful for understanding if a file is actually malicious, what the file may be capable of doing, finding embedded code, as well as isolating related IP addresses, URLs, files, etc. Two log files will be generated. One wih the output of malware-dismantle (MD), and one with the strings of the file. The script will also upload the file to VirusTotal and provide a link to see the analysis (if there is an Internet connection).

### Note:
It is STRONGLY recommended that you input the file as a password-protectd .zip file (password should be "infected"). This is standard in malware analysis to prevent accidental execution.

### Dependencies:
This script currently only runs on Linux systems.
ClamAV, strings, and Binwalk should all be installed already (the script should still run, but you will get a lot of errors).

### Configuration:
Your VirusTotal API key should exit in a file named "VT-api.key" that is two directories up from the script. This can be editted in line 62.
The strings that are specifically searched for are in the Configuration section, line 6 of the file. Three of the string patterns/characters that are searched for are '.', '/', '\', and have specific analysis rules to attempt to isolate IP addresses, file names, file paths, and URLs. The specific accuracy of these can be changed by increasing or decreasing the stringRadius variable.

### Analysis steps:
* unzips the file (if the file was flagged as -z)
* uploads the file to VirusTotal (see the note mentioned in the Configuration section about the placement of your VirusTotal API Key)
* generates an MD5 hash of the file
* details file information
* grabs the strings from the file
* runs an antivirus scan on the file using ClamAV - looking for macros, "phishing signatures", and PUAs
* analyzes the entire file for headers (can take a while for large files, so left as optional)
* removes the unzipped malware
* analyzes the strings - reporting on embedded code, websites, IP addresses, etc
* reports on the findings of VirusTotal

The script will generate a log of the analysis, and provide a link to the VirusTotal report.

## Usage and arguments:
suggested:
> "python Malware-Dismantle.py \<file\> -z"

basic:
> "python Malware-Dismantle.py"

The arguments accepted by the program are the file name, followed by the optional flags "-z" and "-e"
* If the filename is not provided the user will be prompted for it during execution.
* The flag "-z" indicates that the file is zipped with the password "infected" (this setting is highly recommended).
* The flag "-e" (indicating that the file contains executable code) is to automatically trigger the script to scan the file using Binwalk (instead of prompting the user during execution).
